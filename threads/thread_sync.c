#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <pthread.h>
pthread_t tid[2];
int compteur = 0;
pthread_mutex_t mutex;
void *increment(void *args){
     pthread_mutex_lock(&mutex);
    unsigned long i = 0;
    compteur +=1;
    printf("Debut tache %d \n",compteur);
    for(i = 0;i < 1000000000;i++);
    printf("Fin du tache %d \n",compteur);
    pthread_mutex_unlock(&mutex);
    return NULL;
}

int main(){
     int err ,i = 0;
     if(pthread_mutex_init(&mutex,NULL) != 0)
         perror("Creation de mutexg");
     while(i < 2){
         err = pthread_create(&tid[i],NULL,increment,NULL);
         if(err != 0)
             fprintf(stderr,"Erreur de creation de thread: [%d]",err);
         i++;
    }
    pthread_join(tid[0],NULL);
    pthread_join(tid[1],NULL);
    pthread_mutex_destroy(&mutex);
    return 0;
}
