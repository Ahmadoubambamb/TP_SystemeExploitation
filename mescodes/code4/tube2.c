#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <sys/types.h>
#include <fcntl.h>
#include <sys/wait.h>
#include <string.h>
#include <errno.h>
#include <math.h>
#define Buff_size 256
int main(int argc , char* argv[]){
    pid_t pidfils;
    int tube[2];
    double x , y , z;

    puts("Creation de pipe\n");
    if(pipe(tube) != 0){
        fprintf(stderr,"Erreur de Creation de pipe ");
        exit(1);
    }
    pidfils = fork();
    switch(pidfils){
        case -1:
            fprintf(stderr,"Erreur de Creation de fork ");
            exit(errno);
            break;
        case 0:
            close(tube[1]);
            read(tube[0] , &z , sizeof(double));
            printf("Le fils (pid = %d) a lu %.1f\n",getpid(),z);
            break;
        default:
            close(tube[0]);
            //printf("donner un nombre X = ");
           read(0,&x,sizeof(double));
           // y = sqrt((int)x);
            write(tube[1] , &x ,sizeof(double));
           // wait(NULL);
            break;
    }
 return 0;
}
