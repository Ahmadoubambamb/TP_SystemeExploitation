#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <sys/types.h>
#include <fcntl.h>
#include <sys/wait.h>
#include <string.h>
#define Buff_size 256
int main(int argc , char* argv[]){
pid_t pidfils ;
int tube[2];
unsigned char buffR[256] , buffW[256];

 puts("creation de tube\n");
if(pipe(tube) != 0){
    fprintf(stderr,"Erreur dans pipe");
    exit(1);
}
pidfils = fork();

if(pidfils == -1){
      fprintf(stderr,"Erreur dans fork");
    exit(1);
}
else if(pidfils == 0){
    printf("Fermeture des entree dans le fils (PID = %d )\n",getpid());
    close(tube[1]);
    // ecriture
    read(tube[0] , buffR , Buff_size);
    printf("le fils a lu :%s\n",buffR);
}
else{
    printf("Fermeture des sortiees dans le pere (PID = %d) et PID fils = %d\n",getpid(),pidfils);
    close(tube[0]);
    sprintf(buffW,"message du pere (pid = %d) au fils (pid = %d)",getpid(),pidfils);
    write(tube[1] , buffW ,Buff_size);
    wait(NULL);
}
  return 0;
}
