#include <stdio.h>
#include <unistd.h>
#include <fcntl.h>
#include <sys/stat.h>
#include <sys/wait.h>
#include <stdlib.h>
int main(int argc , char const * argv[])
{ if(argc < 3)
{
    printf("erreur nombre argument insuffisant :");
    printf("Usage: %s nomfichier1 nomfichier2 \n",argv[0]);
    return 0;
}
 int tube[2];
 if(pipe(tube) != 0) exit(2);
 pid_t B = fork();
 if(B > 0){
     close(tube[0]);
  int fd = open(argv[1],O_RDONLY);
  if(fd == -1)
  {perror("Erreur d'ouverture :");
      return 0;
  }
  char buff; // buffer de lecture
  int nbRead = 0;
  do {
      nbRead = read(fd , &buff , sizeof(char));
      if(nbRead > 0)
      {
         write(tube[1],&buff,sizeof(char));
    }
 }while(nbRead > 0);
 close(fd);
 wait(NULL);
 }
 else if(B == 0){

      close(tube[1]);
     int fd1 = open(argv[2],O_WRONLY);
     if(fd1 == -1){
         perror("Erreur de d'ouverture et de creation");
         exit(1);
    }
    char buff;
    int nbRead = 0;
    do {
      nbRead = read(tube[1] , &buff , sizeof(char));
      if(nbRead > 0)
      {
         write(fd1,&buff,sizeof(char));
    }
    else perror("readmoins");
 }while(nbRead > 0);
}
 return 0;
}
